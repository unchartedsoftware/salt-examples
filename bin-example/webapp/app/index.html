<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Salt Bin Example</title>
    <meta name="description" content="Example application using Salt to generate Bin tiles">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v1.0.0-rc.1/leaflet.css" />
    <style>
      #map, html, body {
        width: 100%; height: 100%; padding: 0; margin: 0;
      }
    </style>
  </head>

  <body>
    <div id="map"></div>
  </body>

  <script src="http://cdn.leafletjs.com/leaflet/v1.0.0-rc.1/leaflet.js"></script>
  <script src="/vendor/@uncharted/salt/dist/salt.js"></script>

  <script>
    // Map control
    var map = new L.Map('map', {
      zoomControl: true,
      center: [40.7, -73.9],
      zoom: 11,
      maxZoom: 13
    });

    // Base map
    L.tileLayer('http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png', {
      attribution: 'CartoDB'
    }).addTo(map);

    // Get the databounds to provide to canvas layer
    salt.xhr.get('./meta/pickups/meta.json', {}, function(meta) {

      // Create a canvas layer to render the .bins files
      var saltLayerTemperature = new salt.CanvasLayer('./tiles/pickups/{z}/{x}/{y}.bins', {
        // Use the "temperature" color ramp
        ramp: 'temperature',
        // Transform data -> color using a log scale
        transform: 'log10',
        // Spread the range of the color ramp across the entire range of the data
        dynamicRange: [0,1],
        // Provide the zoom-level-wide data bounds
        dataBounds: meta
      });
      map.addLayer(saltLayerTemperature);


      // Create some variants on the same data for demonstration purposes

      // **Note:** In normal use it is cleaner to change the ramp on an existing layer than create 5 variants of the layer itself:
      // saltLayer.setRamp('cool');
      var saltLayerCool = new salt.CanvasLayer('./tiles/pickups/{z}/{x}/{y}.bins', {
        ramp: 'cool',
        dataBounds: meta
      });

      var saltLayerHot = new salt.CanvasLayer('./tiles/pickups/{z}/{x}/{y}.bins', {
        ramp: 'hot',
        dataBounds: meta
      });

      var saltLayerVerdant = new salt.CanvasLayer('./tiles/pickups/{z}/{x}/{y}.bins', {
        ramp: 'verdant',
        dataBounds: meta
      });

      var saltLayerSpectral = new salt.CanvasLayer('./tiles/pickups/{z}/{x}/{y}.bins', {
        ramp: 'spectral',
        dataBounds: meta
      });

      var saltLayerGrey = new salt.CanvasLayer('./tiles/pickups/{z}/{x}/{y}.bins', {
        ramp: 'grey',
        dataBounds: meta
      });

      // Add a control to manage all the layers
      L.control.layers({
        "Temperature": saltLayerTemperature,
        "Cool": saltLayerCool,
        "Hot": saltLayerHot,
        "Verdant": saltLayerVerdant,
        "Spectral": saltLayerSpectral,
        "Grey": saltLayerGrey,
      }).addTo(map);
    });
  </script>
</html>
